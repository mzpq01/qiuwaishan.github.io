<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Littoral Gradient</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.26.0/mapbox-gl.js'></script>
	<script src="http://libs.baidu.com/jquery/2.0.0/jquery.js"></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.26.0/mapbox-gl.css' rel='stylesheet' />
    <script src='https://api.mapbox.com/mapbox.js/v3.0.1/mapbox.js'></script>
	<link href='https://api.mapbox.com/mapbox.js/v3.0.1/mapbox.css' rel='stylesheet' />
    <style>
        h1, h2, h3, h4, h5, h6, ul, li, strong{
            font-size: 0.1em;
            font-weight: 100;
            color: #585858;
            z-index: 1;
            font: 10px/12px Helvetica;
        }
        h1 {
            position: absolute;
            top: : 0px;
            left:10px;
            font-size: 1.3em;
            font-style: black;
            color: black;
        }
        h2 {
          	position: absolute;
            top: 28px;
            left:10px;
            font-size: 0.6em;
        }
        h3 {
          	position: absolute;
            top: 40px;
            left:10px;
            font-size: 0.6em;
        }
        h4 { 
          	position: absolute;
          	text-align: right;         
            right:10px;
            bottom: 50px;
            font-size: 0.3em;
        }
        h5 { 
          	position: absolute;
          	text-align: right;         
            right:10px;
            bottom: 22px;
            font-size: 0.1em;
        }
        h6 { 
          	position: absolute;
          	text-align: right;         
            right:10px;
            bottom: 5px;
            font-size: 0.1em;
        }
        strong { 
			position: relative;         
            font-size: 1.5em;
            font-style: black;
            color: black;
            padding-bottom: 10px;
        }
        body { margin:0; padding:0; }
        #map { position:absolute; top:65px; right: 10px; bottom:0; width:100%; z-index: 0;}
        .mapboxgl-popup-content {
			background: (255,255,255,0.4);
			max-width: 900px; 
			font: 12px Helvetica;
			box-shadow: none;
			word-spacing:0px;
			letter-spacing: 0px;
			max-height:75%;
			overflow-x: hidden;
			overflow-y: auto;
			padding:20px;
			position:absolute;
			top:45%;
			left:65%;
			transform:translate(-50%,-50%);
			display:none;
		}
		p {
		display: block;
		-webkit-margin-before: 0;
		-webkit-margin-after: 0;
		-webkit-margin-start: 0px;
		-webkit-margin-end: 0px;
		}
		.mapboxgl-popup-anchor-bottom 
		.mapboxgl-popup-tip {
			border-top-color: transparent;
			border-bottom-color: transparent;
		}
		#buttons {
        width: 30%;
        margin: 0 auto;
    	}
    	.button {
	        display: inline-block;
	        position: relative;
	        cursor: pointer;
	        padding: 6px;
	        border-radius: 3px;
	        margin-top: 5px;
	        margin-right: 5px;
	        font-size: 10px;
	        text-align: left;
	        color: #000000;
	        background: none;
	        font-family: sans-serif;
	        /*font-weight: bold;*/
	        z-index: 3;
	    }
	    #button-zh{
	    	position: absolute;
	    	top:65px;
	    	left:5px;
	    }
	    #button-en{
	    	position: absolute;
	    	top:65px;
	    	left:60px;
	    }
    </style>
</head>
<body>
    <h1> <font color="black"><b>DEVELOPING THE LITTORAL GRADIENT</b></font> ATLAS</h1>
    <h2> THE <font color="black"><b>SAMUEL TAK LEE MIT REAL ESTATE ENTREPRENEURSHIP</b></font> LAB</h2>
    <h3> THE <font color="black"><b>LEVENTHAL CENTER FOR ADVANCED URBANISM</b></font></h3>
    <h4> <b><font color="black">PI: </b></font>FADI MASOUD, BRENT D. RYAN</h4>
    <h5> <b><font color="black">STUDENTS: </b></font>XI QIU, RICARDO GONZALEZ, CANER OKTEM</p>SEAN PHILLIPS, XHULIO BINJAKU, XINHUI LI, BRANDON</h5>
    <h6> <b><font color="black">WEBSITE DEVELOPER: </b></font>WAISHAN QIU</h6>
    <div class="mapboxgl-popup mapboxgl-popup-anchor-bottom" style="transform: translate(-50%,-100%) translate (483px, 291px);">...</div>
</body>
<div id='map'></div>
<ul id="buttons">
    <li id='button-zh' class='button'>Chinese</li>
    <li id='button-en' class='button'>English</li>
</ul>

<div class="mapboxgl-popup-content">
</div>
<script>
	// Information of the Case Studies as a GeoJSON called 'cases'
	var DIYIcon = "circle"
	var cases =  {
	            "type": "FeatureCollection",
	            "features": [{
	                "type": "Feature",
	                "properties": {
	                    "order":1,
	                    "name_en":"Nanhui/ Lingang New Town",
	                    "name_cn":"上海南汇新城",
	                    "url":"mages/Case_Studies/Revised/Nanhui",
	                    "description": "<img src=\"images/Case_Studies/nanhui lingang_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/nanhui lingang_02.png\" style=\"width:900px;\">",	                  
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [121.921182, 30.899511]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":2,
	                    "name_en":"Lingang District Changxing Island",
	                    "name_cn":"大连长兴岛临港工业区",
	                    "description": "<img src=\"images/Case_Studies/lingang_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/lingang_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [121.522796, 39.599248]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":3,
	                    "name_en": "Caofeidian Industrial Zone",
	                    "name_cn":"唐山曹妃甸经济开发区",
	                    "description": "<img src=\"images/Case_Studies/caofeidian_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/caofeidian_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [118.531952,38.936980]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":4,
	                    "name_en":"Sino-singapore Tianjin Eco-city",
	                    "name_cn":"中新天津生态城",
	                    "description": "<img src=\"images/Case_Studies/tianjin eco_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/tianjin eco_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [117.743740, 39.124365]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":5,
	                    "name_en":"Longkou New Islands",
	                    "name_cn":"龙口湾人工岛群",
	                    "description": "<img src=\"images/Case_Studies/longkou_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/longkou_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [120.325181, 37.659435]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":6,
	                    "name_en":"Xuwei New Area",
	                    "name_cn":"江苏连云港徐圩新区",
	                    "description": "<img src=\"images/Case_Studies/xuwei_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/xuwei_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [119.540398, 34.530439]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":7,
	                    "name_en":"Dongtai Tiaozini Reclamation Project",
	                    "name_cn":"盐城东台条子泥",
	                    "description": "<img src=\"images/Case_Studies/dongtai tiaozini_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/dongtai tiaozini_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [120.845484, 32.812294]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":8,
	                    "name_en":"Taihu New Town",
	                    "name_cn":"太湖新城",
	                    "description": "<img src=\"images/Case_Studies/taihu_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/taihu_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [120.280829, 31.543690]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":9,
	                    "name_en":"Dongtan Eco-city",
	                    "name_cn":"上海崇明东滩生态城",
	                    "description": "<img src=\"images/Case_Studies/dongtan eco_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/dongtan eco_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [121.917181, 31.517100]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":10,
	                    "name_en":"Binhai New Town",
	                    "name_cn":"台州滨海新城",
	                    "description": "<img src=\"images/Case_Studies/binhai_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/binhai_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [121.456179, 29.112174]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":11,
	                    "name_en":"Yuhuan New Town",
	                    "name_cn":"浙江玉环新城",
	                    "description": "<img src=\"images/Case_Studies/yuhuan_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/yuhuan_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [121.277735, 28.217846]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":12,
	                    "name_en":"Shuangyu Island",
	                    "name_cn":"厦门湾南岸双鱼岛",
	                    "description": "<img src=\"images/Case_Studies/shuangyu_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/shuangyu_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [118.071545, 24.375603]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":13,
	                    "name_en":"Pilot Zone for Overseas Chinese Economic and Cultural Cooperation",
	                    "name_cn":"华侨经济文化合作试验区",
	                    "description": "<img src=\"images/Case_Studies/shantou_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/shantou_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [116.794815, 23.351280]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":14,
	                    "name_en":"Overseas Chinese Town",
	                    "name_cn":"深圳白石洲华侨城",
	                    "description": "<img src=\"images/Case_Studies/overseas chinese town_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/overseas chinese town_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [113.981644, 22.542547]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":15,
	                    "name_en":"Shenzhen Bay Park",
	                    "name_cn":"深圳湾公园",
	                    "description": "<img src=\"images/Case_Studies/shenzhen bay_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/shenzhen bay_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [113.897426, 22.467981]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":16,
	                    "name_en":"Shekou Industrial Zone",
	                    "name_cn":"深圳湾蛇口工业区",
	                    "description": "<img src=\"images/Case_Studies/shekou industrial zone_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/shekou industrial zone_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [113.917381, 22.483525]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":17,
	                    "name_en":"Qianhai Modern Service Industry Cooperation",
	                    "name_cn":"前海深港现代服务业合作区",
	                    "description": "<img src=\"images/Case_Studies/qianhai shenzhen_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/qianhai shenzhen_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [113.894893, 22.534546]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":18,
	                    "name_en":"Hong Kong－Zhuhai-Macou Bridge Islands",
	                    "name_cn":"港珠澳大桥人工岛",
	                    "description": "<img src=\"images/Case_Studies/hongkong zhuhai macau_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/hongkong zhuhai macau_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [113.418863, 22.199365]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":19,
	                    "name_en":"Macau Novos Aterros Urbanos",
	                    "name_cn":"澳门新城区",
	                    "description": "<img src=\"images/Case_Studies/novos aterros_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/novos aterros_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [113.564301, 22.143678]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":20,
	                    "name_en":"South Sea Pearl",
	                    "name_cn":"南海明珠生态岛",
	                    "description": "<img src=\"images/Case_Studies/south sea pearl eco_01.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/south sea pearl eco_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [110.196520,20.061184]
	                }
	            }, {
	                "type": "Feature",
	                "properties": {
	                    "order":21,
	                    "name_en":"Pheonix Island",
	                    "name_cn":"三亚凤凰岛",
	                    "description": "<img src=\"images/Case_Studies/pheonix.png\" style=\"width:900px;\"> </p> <img src=\"images/Case_Studies/pheonix_02.png\" style=\"width:900px;\">",
	                    "icon": DIYIcon
	                },
	                "geometry": {
	                    "type": "Point",
	                    "coordinates": [109.493805, 18.240597]
	                }
	            }]
	        };

	mapboxgl.accessToken = 'pk.eyJ1IjoicWl1d2Fpc2hhbiIsImEiOiJjaWVsb3BicnYwMDJ6NHFrbnU2cHVncm56In0.XNz-KrnFme0pU8MdGtYShQ';

	var bounds = [
	    [-30.840902, -60.688536], // Southwest coordinates
	    [340.628814, 80.227860]  // Northeast coordinates
	];

	var map = new mapboxgl.Map({
	    container: 'map',
	    style: 'mapbox://styles/qiuwaishan/ciuaotk5q002u2ipiqdxmpcen',
	    center: [122.819028, 36.676181],
	    zoom: 3.3,
	    maxBounds: bounds
	});

	map.on('load', function() {
	    // Add a GeoJSON source containing place coordinates and information.
	    map.addSource("places", {
	        "type": "geojson",
	        "data": cases	        
	    });

	    // Add a layer showing the places in default condition.
	    map.addLayer({
	    	"id": "cases",
	    	"type":"symbol",
	    	"source":"places",
	    	"layout":{
	    		"icon-image":"{icon}-11",
	    		"icon-allow-overlap": true,
	    		//"text-field":"{name}",
	            "text-offset": [0, 0.5],
	            "text-anchor": "top",
				"text-size" : 11,
	    	}
	    });

	    // Add a layer showing the places in hover condition.
	    map.addLayer({
	    	"id": "cases-hover",
	    	"type":"symbol",
	    	"source":"places",
	    	"layout":{
	    		"icon-image":"{icon}-15",
	    		"icon-allow-overlap": true,
	    		"text-field":"{name_en}" + " | " + "{name_cn}",
	            "text-offset": [1, 0],
	            "text-anchor": "left",
				"text-size" : 10,
				"icon-ignore-placement": true,
				"text-ignore-placement": true
	    	},
	    	"filter": ['==', 'order', '9999']
	    });
	});

	// Create a popup, but don't add it to the map yet.
	/*var popup = new mapboxgl.Popup({
	    closeButton: false,
	    closeOnClick: false,
		anchor:'bottom-left',
	    offset: 5
	});
*/
	map.on('mousemove', function(e) {
	    var features = map.queryRenderedFeatures(e.point, { layers: ['cases'] });
	    // Change the cursor style as a UI indicator.
	    map.getCanvas().style.cursor = (features.length) ? 'pointer' : '';

	    if (!features.length) {
	        popup.remove();
	        return;
	    }
	    var order = features[0].properties.order;
		map.setFilter( 'cases-hover', ['==', 'order', order]);
	});


		// When a click event occurs near a place, open a popup at the location of
	// the feature, with description HTML from its properties.
	map.on('click', function (e) {
	    var features = map.queryRenderedFeatures(e.point, { layers: ['cases'] });
	    if (!features.length) {
			$(".mapboxgl-popup-content").hide();
	        return;
	    }
	    var feature = features[0];
		$(".mapboxgl-popup-content").html("<p><strong>"+feature.properties.name_en + " | " +feature.properties.name_cn +"</strong></p>" +"<p> </p>"+feature.properties.description).show();
	   /* var popup = new mapboxgl.Popup({
	    closeButton: false,
	    closeOnClick: false,
		anchor:'left',
	    offset: 5
		})
        .setLngLat(feature.geometry.coordinates)
	    .setHTML(feature.properties.description)
	    .addTo(map);*/
		
	});

	// Add zoom and rotation controls to the map.
	map.addControl(new mapboxgl.NavigationControl());

	map.addControl(new mapboxgl.ScaleControl({
	    maxWidth: 100,
	    unit: 'metric'
	}));

	document.getElementById('buttons').addEventListener('click', function(event) {
	    var language = event.target.id.substr('button-'.length);
	    // Use setLayoutProperty to set the value of a layout property in a style layer.
	    // The three arguments are the id of the layer, the name of the layout property,
	    // and the new property value.
	    var layout= ['country-label-lg','country-label-md','country-label-sm','place-city-lg-n','place-city-lg-s','place-city-md-n','place-city-md-s','place-city-sm'];
	    var val;
		for (val of layout) {
		    map.setLayoutProperty(val, 'text-field', '{name_' + language + '}');
		};
	});

</script>

</body>
</html>